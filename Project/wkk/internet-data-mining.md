# 互联网数据挖掘

万小军 http://www.icst.pku.edu.cn/lcwm

<!-- MarkdownTOC -->

- 数据挖掘概述与关联规则挖掘
    - 数据挖掘流程
    - 数据挖掘任务
    - 分类
        - 基于规则的分类
        - 基于统计的分类
        - 文本统计分类流程
        - 文本分类-特征向量表示
        - 文本分类-特征选择
        - 朴素贝叶斯分类
        - Rocchio 分类方法
        - K 近邻分类方法
        - 支持向量机 Support Vector Machine
    - 聚类定义
    - 关联规则挖掘：定义
    - 摘要
    - 回归
    - 偏差/异常检测
    - 数据挖掘工具
    - 数据挖掘的挑战

<!-- /MarkdownTOC -->

## 数据挖掘概述与关联规则挖掘

数据挖掘从多学科领域发展而来：Statistics/AI, Machine Learning, Pattern Recognition, Database systems

### 数据挖掘流程

**Data** -Selection-> **Target data** -Preprocessing-> **Preprocessed data** -Transformation-> **Transformed data** -Data mining-> **Patterns** -Interpretation/evaluatoin-> **Knowledge**

### 数据挖掘任务

+ 预测型(Prediction Methods): 基于一些变量预测其他变量的未知值或未来值
    + 分类 Classification
    + 回归 Regression
    + 偏差检测 Deviation Detection
+ 描述型(Description Methods): 发现描述数据的人们可解释的模式
    + 聚类 Clustering
    + 关联规则挖掘 Association Rule Discovery
    + 摘要 Summarization

### 分类

将数据划分到已知类别。分类器的构建基于有监督学习(标注数据:训练集)

+ 给定一个样例集合(训练集)
    + 每个样例包含一个属性集合，其中一个属性是类标记/类号
+ 基于训练集构建一个模型，该模型将类标记属性看作是其它属性值的一个函数
+ 目标：对心的样例尽可能准确地赋予标记
    + 基于一个测试集来评估模型的准确性

Training Set -> Learn Classifier -> Model <- Test set

+ 二类分类：正、负
+ 多类分类：多类(>=3)

二类分类是分类问题的最基本形式，多类分类问题可通过转化为二类分类问题加以解决。

+ One vs. One
    + 对于 K 类分类需要 K(K-1)/2 个二类分类器
    + 测试分类时采用投票方式确定类别
    + E.g. Labels: a, b, c
    + 分类器: a vs b, b vs c, a vs c
+ One vs. All(Rest):
    + 对于 K 类分类需要 K 个二类分类器
    + 测试分类时取返回最大值的类别
    + E.g. Labels: a, b, c
    + 分类器: a vs (b, c), b vs (a, c), c vs (a, b)

层次式分类，类别构成层次式结构(树状)。中图法、ODP目录。

+ 应用
    + 新闻分类
    + 广告页面判别
    + 垃圾邮件过滤
    + 垃圾短信过滤
    + 博客风格判断
    + 评论情感分析

#### 基于规则的分类

人工/专家制定分类规则，使用布尔操作符(AND, OR, NOT)，可将规则组织成决策树，节点代表规则，叶节点代表类别

+ 优势
    + 透明，易于理解，易于修改
+ 劣势
    + 复杂，耗时
    + 主要依赖人工/专家的智能，而非系统/机器智能
    + 不易拓展
    + 绝对的类别划分，无置信度

#### 基于统计的分类

+ 优势
    + 可以输出置信概率、允许阈值控制、可扩展
+ 劣势
    + 需要已标注好的训练数据
+ 典型方法
    + 朴素贝叶斯
    + Rocchio
    + K 近邻
    + 支持向量机

#### 文本统计分类流程

+ 预处理
    + Tokenization
    + Filtering
    + Stemming
+ 特征计算
    + tf
    + Log(tf+1)
    + tfidf
+ 特征选择
    + MI
    + Chi-Square
    + Information Gain
+ 分类学习
    + SVM
    + Rocchio
    + Naive Bayes
+ 结果评估
    + Recall
    + F-Measure
    + Precision

#### 文本分类-特征向量表示

+ 文本表示为特征向量
    + 词语(term): 基本单元
    + 权重 TF * IDF
        + TF: 词频
        + IDF: log(N/DF), N 为文档总数量，DF 为包含该词语的文档数量

#### 文本分类-特征选择

+ 好处
    + 减少特征维数，改善效果
    + 防止过拟合，增强模型的泛化能力
    + 提高学习效率
    + 提高模型的可解释性
+ 方法，从原有特征集合中找出一个更加有效的子集
    + Document Frequency 文档频率
        + 词语的 DF 小于某个阈值去掉(太小，没有代表性)
        + 词语的 DF 大于某个阈值也去掉(太多，没有区分度)
    + Mutual Information 互信息
        + MI 越大词语 t 和 c 共现程度越大
    + Information Gain 信息增益
        + 词语 t 为整个分类所能提供的信息量(不考虑任何特征的熵和考虑该特征后的熵的差值)
    + Information Ratio
    + Chi Squrae
    + Odd Ratio

#### 朴素贝叶斯分类

+ 基于概率理论的学习和分类方法
+ 贝叶斯理论充当重要角色
+ 分类是根据给定样本描述的可能的类别基础上产生的后验概率分布
    + 基于贝叶斯理论来计算后验概率
+ 分类原理：最大后验估计 MAP(maximum posteriori)

#### Rocchio 分类方法

+ 使用中心向量(centroid vector)表示一个类别
    + 中心向量为某个类别下所有文档向量的平均向量
    + 基于训练集计算
+ 对于新文档，计算该文档与每个类别的中心向量的距离/相似度
    + 基于余弦测度
+ 确定其类别为距离最小/相似性最大的类别
+ 优势: 训练快速，模型很小，快速分类
+ 劣势: 类别数量增加时准确率降低

#### K 近邻分类方法

+ 与 Rocchio 方法类似
+ 检查新文档的 k 个近邻向量，利用这些近邻向量的类别来确定该文档的类别
    + K 通过实验确定
    + “近邻” 通过相似度/距离测度来定义
+ 1 近邻分类方法
    + 将新文档划分到与其最相近的文档样例所属的类别
+ K 近邻分类方法
    + 基于投票机制，将新文档划分到 k 个近邻文档中多数文档所属的类别
    + 进一步，基于加权投票机制，根据近邻文档的相近程度，赋予每个近邻文档一定的权重
+ 优势
    + 不需要训练阶段
    + 类别数量增加也具有良好的扩展性
+ 劣势
    + 训练数据很大时模型很大
    + 需要大量内存
    + 性能较慢

#### 支持向量机 Support Vector Machine

+ 对于二类分类，该方法在向量空间中找出一个决策超平面(分类函数 f(x) = wx + b)，对属于两个类别的文档向量进行有效粉绿
    + 通常有很多可能的分割超平面
    + 找到最好的一个超平面: 最大间隔准则
        + 使得属于不同类别的数据点间隔最大
    + 间隔区边缘上的向量称为支撑向量
+ 实际上要求解一个带约束的二次规划(quadratic programming, QP)问题
+ 训练结果
    + 支撑向量
+ 分类
    + 计算新文档向量与支撑向量的距离
+ 常用工具
    + SVMLight
    + LIBSVM
+ 优势
    + 只有支撑向量用来对新文档分类
    + 模型小
    + 一般不会过拟合
+ 劣势
    + 训练过程非常复杂: 优化问题


### 聚类定义

+ 给定一个数据点集合，每个数据点具有一组属性，数据点之间能进行相似度度量，聚类目标为找到若干类簇：
    + 同一类簇中的数据点相似
    + 不同类簇中的数据点不相似
+ 相似度度量准则
    + 欧氏距离
    + 其他面向特定问题的准则：余弦准则

应用：文档聚类

+ 目标：发现文档类簇，同一类簇中文档相似(基于重要词语)
+ 方法：识别每篇文档中的重要词语，基于文档相似性进行聚类

### 关联规则挖掘：定义

关联规则反映一个事物与其他事物之间的相互依存性和关联性。如果两个或者多个事物之间存在一定的关联关系，那么其中一个事物就能够通过其他事物预测到。关联规则表示了项之间的关系。

+ 给定一个记录集合，每个记录包含若干项
    + 产生依赖规则，可以基于某些项的出现预测一个项的出现

应用：市场营销

+ 假如发现一条规则
+ {面包圈..} -> {薯片}
+ 可以帮助提高薯片的销量

### 摘要

为数据集进行总结，提供一个简洁/紧凑的表示，包括可视化与报表生成

### 回归

+ 基于若干变量的值预测一个给定的具有连续值的变量的值
    + 假设一个线性或非线性的依赖模型
+ 举例
    + 基于广告开支预测新产品的销售额
    + 基于温度、湿度、气压等预测风速
    + 预测股票指数

### 偏差/异常检测

+ 从正常行为中检测显著的偏差/异常
+ 举例
    + 信用卡欺诈检测
    + 网络入侵检测

### 数据挖掘工具

+ Free open-source software and application
    + Weka
    + GATE
    + Carrot2
    + NLTK
    + Orange
    + RapidMiner
    + KNIME
+ Commercial software
    + IBM InfoSphere Warehouse
    + Microsoft Analysis Services
    + SAS Enterprise Miner
    + STATISTICA Data Miner
    + Oracle Data Mining

### 数据挖掘的挑战

+ 可拓展性
+ 挖掘高维数据、高速数据流
+ 挖掘序列数据、时间序列数据
+ 从复杂、异构、网络化数据中挖掘复杂知识
+ 挖掘低质量数据
+ 安全性、隐私保护
